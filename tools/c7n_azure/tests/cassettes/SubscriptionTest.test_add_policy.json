{
    "version": 1,
    "interactions": [
        {
            "request": {
                "method": "GET",
                "uri": "https://management.azure.com/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47?api-version=2016-06-01",
                "body": null,
                "headers": {}
            },
            "response": {
                "status": {
                    "code": 200,
                    "message": "OK"
                },
                "headers": {
                    "x-ms-routing-request-id": [
                        "WESTUS2:20190503T151547Z:9172cfa9-ef38-4d3c-bc26-1795ab25e4de"
                    ],
                    "content-length": [
                        "320"
                    ],
                    "x-ms-request-id": [
                        "9172cfa9-ef38-4d3c-bc26-1795ab25e4de"
                    ],
                    "Pragma": [
                        "no-cache"
                    ],
                    "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains"
                    ],
                    "Date": [
                        "Fri, 03 May 2019 15:15:46 GMT"
                    ],
                    "X-Content-Type-Options": [
                        "nosniff"
                    ],
                    "x-ms-ratelimit-remaining-subscription-reads": [
                        "11997"
                    ],
                    "Content-Type": [
                        "application/json; charset=utf-8"
                    ],
                    "Vary": [
                        "Accept-Encoding"
                    ],
                    "x-ms-correlation-request-id": [
                        "9172cfa9-ef38-4d3c-bc26-1795ab25e4de"
                    ],
                    "Expires": [
                        "-1"
                    ],
                    "Cache-Control": [
                        "no-cache"
                    ]
                },
                "body": {
                    "string": "{\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"subscriptionId\":\"ea42f556-5106-4743-99b0-c129bfa71a47\",\"displayName\":\"Cloud Custodian\",\"state\":\"Enabled\",\"subscriptionPolicies\":{\"locationPlacementId\":\"Internal_2014-09-01\",\"quotaId\":\"Internal_2014-09-01\",\"spendingLimit\":\"Off\"},\"authorizationSource\":\"Legacy\"}"
                }
            }
        },
        {
            "request": {
                "method": "GET",
                "uri": "https://management.azure.com/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments?api-version=2018-03-01",
                "body": null,
                "headers": {}
            },
            "response": {
                "status": {
                    "code": 200,
                    "message": "OK"
                },
                "headers": {
                    "x-ms-routing-request-id": [
                        "WESTUS2:20190503T151547Z:0dddf77d-dc5d-4480-9da4-083561ae8e1f"
                    ],
                    "x-ms-request-id": [
                        "westus2:e3a34feb-da5a-428a-b687-447d42a6dd42"
                    ],
                    "Pragma": [
                        "no-cache"
                    ],
                    "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains"
                    ],
                    "Transfer-Encoding": [
                        "chunked"
                    ],
                    "X-Content-Type-Options": [
                        "nosniff"
                    ],
                    "Date": [
                        "Fri, 03 May 2019 15:15:47 GMT"
                    ],
                    "x-ms-ratelimit-remaining-subscription-reads": [
                        "11999"
                    ],
                    "Content-Type": [
                        "application/json; charset=utf-8"
                    ],
                    "Vary": [
                        "Accept-Encoding,Accept-Encoding"
                    ],
                    "x-ms-correlation-request-id": [
                        "0dddf77d-dc5d-4480-9da4-083561ae8e1f"
                    ],
                    "Expires": [
                        "-1"
                    ],
                    "Cache-Control": [
                        "no-cache"
                    ],
                    "content-length": [
                        "5052"
                    ]
                },
                "body": {
                    "string": "{\"value\":[{\"sku\":{\"name\":\"A0\",\"tier\":\"Free\"},\"properties\":{\"displayName\":\"cctestpolicy\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"metadata\":{\"createdBy\":\"3857c640-b81d-4a7b-b006-ca39332fddb2\",\"createdOn\":\"2019-05-01T22:48:36.8615186Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"cctestpolicy\"},{\"sku\":{\"name\":\"A1\",\"tier\":\"Standard\"},\"properties\":{\"displayName\":\"ASC DataProtection (subscription: ea42f556-5106-4743-99b0-c129bfa71a47)\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"description\":\"This policy assignment was automatically created by Azure Security Center\",\"metadata\":{\"assignedBy\":\"Security Center\",\"createdBy\":\"6878917f-bc1d-4e4e-bb24-12924205b215\",\"createdOn\":\"2019-03-04T15:23:23.8847211Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"DataProtectionSecurityCenter\"},{\"sku\":{\"name\":\"A1\",\"tier\":\"Standard\"},\"properties\":{\"displayName\":\"ASC Default (subscription: ea42f556-5106-4743-99b0-c129bfa71a47)\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"parameters\":{\"diagnosticsLogsInServiceFabricMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"systemUpdatesMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"systemConfigurationsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"endpointProtectionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diskEncryptionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"networkSecurityGroupsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"webApplicationFirewallMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"sqlAuditingMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"sqlEncryptionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"nextGenerationFirewallMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"vulnerabilityAssesmentMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"storageEncryptionMonitoringEffect\":{\"value\":\"Audit\"},\"jitNetworkAccessMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"adaptiveApplicationControlsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityDesignateLessThanOwnersMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityDesignateMoreThanOneOwnerMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForWritePermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForReadPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveDeprecatedAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"secureTransferToStorageAccountMonitoringEffect\":{\"value\":\"Audit\"},\"aadAuthenticationInSqlServerMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInRedisCacheMonitoringEffect\":{\"value\":\"Audit\"},\"clusterProtectionLevelInServiceFabricMonitoringEffect\":{\"value\":\"Audit\"},\"aadAuthenticationInServiceFabricMonitoringEffect\":{\"value\":\"Audit\"},\"diagnosticsLogsInServiceBusMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInDataLakeStoreMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInBatchAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInEventHubMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"metricAlertsInBatchAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"namespaceAuthorizationRulesInServiceBusMonitoringEffect\":{\"value\":\"Audit\"},\"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\":{\"value\":\"Audit\"},\"classicComputeVMsMonitoringEffect\":{\"value\":\"Audit\"},\"classicStorageAccountsMonitoringEffect\":{\"value\":\"Audit\"},\"sqlDbVulnerabilityAssesmentMonitoringEffect\":{\"value\":\"AuditIfNotExists\"}},\"description\":\"This policy assignment was automatically created by Azure Security Center\",\"metadata\":{\"assignedBy\":\"Security Center\"}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"SecurityCenterBuiltIn\"}]}"
                }
            }
        },
        {
            "request": {
                "method": "PUT",
                "uri": "https://management.azure.com/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy_sub?api-version=2018-03-01",
                "body": "mock_body",
                "headers": {}
            },
            "response": {
                "status": {
                    "code": 201,
                    "message": "Created"
                },
                "headers": {
                    "Content-Length": [
                        "604"
                    ],
                    "x-ms-routing-request-id": [
                        "WESTUS2:20190503T151552Z:41e13fb4-a93f-4945-bead-11bd5c62e4b3"
                    ],
                    "x-ms-request-id": [
                        "westus2:925b4ac3-aae7-4338-a0bc-917bf3221834"
                    ],
                    "Pragma": [
                        "no-cache"
                    ],
                    "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains"
                    ],
                    "x-ms-ratelimit-remaining-subscription-writes": [
                        "1199"
                    ],
                    "X-Content-Type-Options": [
                        "nosniff"
                    ],
                    "Date": [
                        "Fri, 03 May 2019 15:15:52 GMT"
                    ],
                    "Content-Type": [
                        "application/json; charset=utf-8"
                    ],
                    "x-ms-correlation-request-id": [
                        "41e13fb4-a93f-4945-bead-11bd5c62e4b3"
                    ],
                    "Expires": [
                        "-1"
                    ],
                    "Cache-Control": [
                        "no-cache"
                    ]
                },
                "body": {
                    "string": "{\"sku\":{\"name\":\"A0\",\"tier\":\"Free\"},\"properties\":{\"displayName\":\"cctestpolicy_sub\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"metadata\":{\"createdBy\":\"3857c640-b81d-4a7b-b006-ca39332fddb2\",\"createdOn\":\"2019-05-03T15:15:48.3275321Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy_sub\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"cctestpolicy_sub\"}"
                }
            }
        },
        {
            "request": {
                "method": "GET",
                "uri": "https://management.azure.com/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47?api-version=2016-06-01",
                "body": null,
                "headers": {}
            },
            "response": {
                "status": {
                    "code": 200,
                    "message": "OK"
                },
                "headers": {
                    "x-ms-routing-request-id": [
                        "WESTUS2:20190503T151549Z:42c226fd-e62e-422a-bd14-1c724a9f93ff"
                    ],
                    "content-length": [
                        "320"
                    ],
                    "x-ms-request-id": [
                        "42c226fd-e62e-422a-bd14-1c724a9f93ff"
                    ],
                    "Pragma": [
                        "no-cache"
                    ],
                    "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains"
                    ],
                    "Date": [
                        "Fri, 03 May 2019 15:15:48 GMT"
                    ],
                    "X-Content-Type-Options": [
                        "nosniff"
                    ],
                    "x-ms-ratelimit-remaining-subscription-reads": [
                        "11998"
                    ],
                    "Content-Type": [
                        "application/json; charset=utf-8"
                    ],
                    "Vary": [
                        "Accept-Encoding"
                    ],
                    "x-ms-correlation-request-id": [
                        "42c226fd-e62e-422a-bd14-1c724a9f93ff"
                    ],
                    "Expires": [
                        "-1"
                    ],
                    "Cache-Control": [
                        "no-cache"
                    ]
                },
                "body": {
                    "string": "{\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"subscriptionId\":\"ea42f556-5106-4743-99b0-c129bfa71a47\",\"displayName\":\"Cloud Custodian\",\"state\":\"Enabled\",\"subscriptionPolicies\":{\"locationPlacementId\":\"Internal_2014-09-01\",\"quotaId\":\"Internal_2014-09-01\",\"spendingLimit\":\"Off\"},\"authorizationSource\":\"Legacy\"}"
                }
            }
        },
        {
            "request": {
                "method": "GET",
                "uri": "https://management.azure.com/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments?api-version=2018-03-01",
                "body": null,
                "headers": {}
            },
            "response": {
                "status": {
                    "code": 200,
                    "message": "OK"
                },
                "headers": {
                    "x-ms-routing-request-id": [
                        "WESTUS2:20190503T151549Z:891b167d-eb9f-4747-978b-d2617ab9eb53"
                    ],
                    "x-ms-request-id": [
                        "westus2:98905b22-f481-471b-ad5e-66dbf44b1bc6"
                    ],
                    "Pragma": [
                        "no-cache"
                    ],
                    "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains"
                    ],
                    "Transfer-Encoding": [
                        "chunked"
                    ],
                    "X-Content-Type-Options": [
                        "nosniff"
                    ],
                    "Date": [
                        "Fri, 03 May 2019 15:15:49 GMT"
                    ],
                    "x-ms-ratelimit-remaining-subscription-reads": [
                        "11999"
                    ],
                    "Content-Type": [
                        "application/json; charset=utf-8"
                    ],
                    "Vary": [
                        "Accept-Encoding,Accept-Encoding"
                    ],
                    "x-ms-correlation-request-id": [
                        "891b167d-eb9f-4747-978b-d2617ab9eb53"
                    ],
                    "Expires": [
                        "-1"
                    ],
                    "Cache-Control": [
                        "no-cache"
                    ],
                    "content-length": [
                        "5657"
                    ]
                },
                "body": {
                    "string": "{\"value\":[{\"sku\":{\"name\":\"A0\",\"tier\":\"Free\"},\"properties\":{\"displayName\":\"cctestpolicy\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"metadata\":{\"createdBy\":\"3857c640-b81d-4a7b-b006-ca39332fddb2\",\"createdOn\":\"2019-05-01T22:48:36.8615186Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"cctestpolicy\"},{\"sku\":{\"name\":\"A0\",\"tier\":\"Free\"},\"properties\":{\"displayName\":\"cctestpolicy_sub\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"metadata\":{\"createdBy\":\"3857c640-b81d-4a7b-b006-ca39332fddb2\",\"createdOn\":\"2019-05-03T15:15:48.3275321Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy_sub\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"cctestpolicy_sub\"},{\"sku\":{\"name\":\"A1\",\"tier\":\"Standard\"},\"properties\":{\"displayName\":\"ASC DataProtection (subscription: ea42f556-5106-4743-99b0-c129bfa71a47)\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"description\":\"This policy assignment was automatically created by Azure Security Center\",\"metadata\":{\"assignedBy\":\"Security Center\",\"createdBy\":\"6878917f-bc1d-4e4e-bb24-12924205b215\",\"createdOn\":\"2019-03-04T15:23:23.8847211Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"DataProtectionSecurityCenter\"},{\"sku\":{\"name\":\"A1\",\"tier\":\"Standard\"},\"properties\":{\"displayName\":\"ASC Default (subscription: ea42f556-5106-4743-99b0-c129bfa71a47)\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"parameters\":{\"diagnosticsLogsInServiceFabricMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"systemUpdatesMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"systemConfigurationsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"endpointProtectionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diskEncryptionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"networkSecurityGroupsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"webApplicationFirewallMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"sqlAuditingMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"sqlEncryptionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"nextGenerationFirewallMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"vulnerabilityAssesmentMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"storageEncryptionMonitoringEffect\":{\"value\":\"Audit\"},\"jitNetworkAccessMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"adaptiveApplicationControlsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityDesignateLessThanOwnersMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityDesignateMoreThanOneOwnerMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForWritePermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForReadPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveDeprecatedAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"secureTransferToStorageAccountMonitoringEffect\":{\"value\":\"Audit\"},\"aadAuthenticationInSqlServerMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInRedisCacheMonitoringEffect\":{\"value\":\"Audit\"},\"clusterProtectionLevelInServiceFabricMonitoringEffect\":{\"value\":\"Audit\"},\"aadAuthenticationInServiceFabricMonitoringEffect\":{\"value\":\"Audit\"},\"diagnosticsLogsInServiceBusMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInDataLakeStoreMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInBatchAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInEventHubMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"metricAlertsInBatchAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"namespaceAuthorizationRulesInServiceBusMonitoringEffect\":{\"value\":\"Audit\"},\"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\":{\"value\":\"Audit\"},\"classicComputeVMsMonitoringEffect\":{\"value\":\"Audit\"},\"classicStorageAccountsMonitoringEffect\":{\"value\":\"Audit\"},\"sqlDbVulnerabilityAssesmentMonitoringEffect\":{\"value\":\"AuditIfNotExists\"}},\"description\":\"This policy assignment was automatically created by Azure Security Center\",\"metadata\":{\"assignedBy\":\"Security Center\"}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"SecurityCenterBuiltIn\"}]}"
                }
            }
        },
        {
            "request": {
                "method": "GET",
                "uri": "https://management.azure.com/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments?api-version=2018-03-01",
                "body": null,
                "headers": {}
            },
            "response": {
                "status": {
                    "code": 200,
                    "message": "OK"
                },
                "headers": {
                    "x-ms-routing-request-id": [
                        "WESTUS2:20190503T151549Z:7d2ed4a4-cea3-4a66-b34c-06cdf4d161e2"
                    ],
                    "x-ms-request-id": [
                        "westus2:f2f6de5e-f81e-4909-a68c-bfa5a6f7798e"
                    ],
                    "Pragma": [
                        "no-cache"
                    ],
                    "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains"
                    ],
                    "Transfer-Encoding": [
                        "chunked"
                    ],
                    "X-Content-Type-Options": [
                        "nosniff"
                    ],
                    "Date": [
                        "Fri, 03 May 2019 15:15:49 GMT"
                    ],
                    "x-ms-ratelimit-remaining-subscription-reads": [
                        "11999"
                    ],
                    "Content-Type": [
                        "application/json; charset=utf-8"
                    ],
                    "Vary": [
                        "Accept-Encoding,Accept-Encoding"
                    ],
                    "x-ms-correlation-request-id": [
                        "7d2ed4a4-cea3-4a66-b34c-06cdf4d161e2"
                    ],
                    "Expires": [
                        "-1"
                    ],
                    "Cache-Control": [
                        "no-cache"
                    ],
                    "content-length": [
                        "5657"
                    ]
                },
                "body": {
                    "string": "{\"value\":[{\"sku\":{\"name\":\"A0\",\"tier\":\"Free\"},\"properties\":{\"displayName\":\"cctestpolicy\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"metadata\":{\"createdBy\":\"3857c640-b81d-4a7b-b006-ca39332fddb2\",\"createdOn\":\"2019-05-01T22:48:36.8615186Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"cctestpolicy\"},{\"sku\":{\"name\":\"A0\",\"tier\":\"Free\"},\"properties\":{\"displayName\":\"cctestpolicy_sub\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"metadata\":{\"createdBy\":\"3857c640-b81d-4a7b-b006-ca39332fddb2\",\"createdOn\":\"2019-05-03T15:15:48.3275321Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy_sub\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"cctestpolicy_sub\"},{\"sku\":{\"name\":\"A1\",\"tier\":\"Standard\"},\"properties\":{\"displayName\":\"ASC DataProtection (subscription: ea42f556-5106-4743-99b0-c129bfa71a47)\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"description\":\"This policy assignment was automatically created by Azure Security Center\",\"metadata\":{\"assignedBy\":\"Security Center\",\"createdBy\":\"6878917f-bc1d-4e4e-bb24-12924205b215\",\"createdOn\":\"2019-03-04T15:23:23.8847211Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"DataProtectionSecurityCenter\"},{\"sku\":{\"name\":\"A1\",\"tier\":\"Standard\"},\"properties\":{\"displayName\":\"ASC Default (subscription: ea42f556-5106-4743-99b0-c129bfa71a47)\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"parameters\":{\"diagnosticsLogsInServiceFabricMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"systemUpdatesMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"systemConfigurationsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"endpointProtectionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diskEncryptionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"networkSecurityGroupsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"webApplicationFirewallMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"sqlAuditingMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"sqlEncryptionMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"nextGenerationFirewallMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"vulnerabilityAssesmentMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"storageEncryptionMonitoringEffect\":{\"value\":\"Audit\"},\"jitNetworkAccessMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"adaptiveApplicationControlsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityDesignateLessThanOwnersMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityDesignateMoreThanOneOwnerMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForWritePermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityEnableMFAForReadPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveDeprecatedAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"secureTransferToStorageAccountMonitoringEffect\":{\"value\":\"Audit\"},\"aadAuthenticationInSqlServerMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInRedisCacheMonitoringEffect\":{\"value\":\"Audit\"},\"clusterProtectionLevelInServiceFabricMonitoringEffect\":{\"value\":\"Audit\"},\"aadAuthenticationInServiceFabricMonitoringEffect\":{\"value\":\"Audit\"},\"diagnosticsLogsInServiceBusMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInDataLakeStoreMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInBatchAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"diagnosticsLogsInEventHubMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"metricAlertsInBatchAccountMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"namespaceAuthorizationRulesInServiceBusMonitoringEffect\":{\"value\":\"Audit\"},\"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\":{\"value\":\"Audit\"},\"classicComputeVMsMonitoringEffect\":{\"value\":\"Audit\"},\"classicStorageAccountsMonitoringEffect\":{\"value\":\"Audit\"},\"sqlDbVulnerabilityAssesmentMonitoringEffect\":{\"value\":\"AuditIfNotExists\"}},\"description\":\"This policy assignment was automatically created by Azure Security Center\",\"metadata\":{\"assignedBy\":\"Security Center\"}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"SecurityCenterBuiltIn\"}]}"
                }
            }
        },
        {
            "request": {
                "method": "GET",
                "uri": "https://management.azure.com/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization?api-version=2018-05-01",
                "body": null,
                "headers": {}
            },
            "response": {
                "status": {
                    "code": 200,
                    "message": "OK"
                },
                "headers": {
                    "x-ms-routing-request-id": [
                        "WESTUS2:20190503T151550Z:4b5fc41b-8277-4c07-b4a5-e840b0904792"
                    ],
                    "content-length": [
                        "3519"
                    ],
                    "x-ms-request-id": [
                        "4b5fc41b-8277-4c07-b4a5-e840b0904792"
                    ],
                    "Pragma": [
                        "no-cache"
                    ],
                    "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains"
                    ],
                    "Date": [
                        "Fri, 03 May 2019 15:15:50 GMT"
                    ],
                    "X-Content-Type-Options": [
                        "nosniff"
                    ],
                    "x-ms-ratelimit-remaining-subscription-reads": [
                        "11997"
                    ],
                    "Content-Type": [
                        "application/json; charset=utf-8"
                    ],
                    "Vary": [
                        "Accept-Encoding"
                    ],
                    "x-ms-correlation-request-id": [
                        "4b5fc41b-8277-4c07-b4a5-e840b0904792"
                    ],
                    "Expires": [
                        "-1"
                    ],
                    "Cache-Control": [
                        "no-cache"
                    ]
                },
                "body": {
                    "string": "{\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization\",\"namespace\":\"Microsoft.Authorization\",\"resourceTypes\":[{\"resourceType\":\"roleAssignments\",\"locations\":[],\"apiVersions\":[\"2018-12-01-preview\",\"2018-09-01-preview\",\"2018-01-01-preview\",\"2017-10-01-preview\",\"2017-09-01\",\"2017-05-01\",\"2016-07-01\",\"2015-07-01\",\"2015-06-01\",\"2015-05-01-preview\",\"2014-10-01-preview\",\"2014-07-01-preview\",\"2014-04-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2017-09-01\"}]},{\"resourceType\":\"roleDefinitions\",\"locations\":[],\"apiVersions\":[\"2018-01-01-preview\",\"2017-09-01\",\"2017-05-01\",\"2016-07-01\",\"2015-07-01\",\"2015-06-01\",\"2015-05-01-preview\",\"2014-10-01-preview\",\"2014-07-01-preview\",\"2014-04-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2017-05-01\"}]},{\"resourceType\":\"classicAdministrators\",\"locations\":[],\"apiVersions\":[\"2015-06-01\",\"2015-05-01-preview\",\"2014-10-01-preview\",\"2014-07-01-preview\",\"2014-04-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2015-06-01\"}]},{\"resourceType\":\"permissions\",\"locations\":[],\"apiVersions\":[\"2018-01-01-preview\",\"2017-05-01\",\"2016-07-01\",\"2015-07-01\",\"2015-06-01\",\"2015-05-01-preview\",\"2014-10-01-preview\",\"2014-07-01-preview\",\"2014-04-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2017-05-01\"}]},{\"resourceType\":\"denyAssignments\",\"locations\":[],\"apiVersions\":[\"2019-03-01-preview\",\"2018-07-01-preview\",\"2018-07-01\"]},{\"resourceType\":\"locks\",\"locations\":[],\"apiVersions\":[\"2017-04-01\",\"2016-09-01\",\"2015-06-01\",\"2015-05-01-preview\",\"2015-01-01\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2017-04-01\"}]},{\"resourceType\":\"operations\",\"locations\":[],\"apiVersions\":[\"2017-05-01\",\"2016-07-01\",\"2015-07-01\",\"2015-01-01\",\"2014-10-01-preview\",\"2014-06-01\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2017-05-01\"}]},{\"resourceType\":\"policyDefinitions\",\"locations\":[],\"apiVersions\":[\"2019-01-01\",\"2018-05-01\",\"2018-03-01\",\"2016-12-01\",\"2016-04-01\",\"2015-10-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2018-03-01\"}]},{\"resourceType\":\"policySetDefinitions\",\"locations\":[],\"apiVersions\":[\"2019-01-01\",\"2018-05-01\",\"2018-03-01\",\"2017-06-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2018-03-01\"}]},{\"resourceType\":\"policyAssignments\",\"locations\":[],\"apiVersions\":[\"2019-01-01\",\"2018-05-01\",\"2018-03-01\",\"2017-06-01-preview\",\"2016-12-01\",\"2016-04-01\",\"2015-10-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2018-03-01\"}],\"capabilities\":\"SystemAssignedResourceIdentity\"},{\"resourceType\":\"dataAliases\",\"locations\":[],\"apiVersions\":[\"2018-06-01-preview\"]},{\"resourceType\":\"providerOperations\",\"locations\":[],\"apiVersions\":[\"2018-01-01-preview\",\"2017-05-01\",\"2016-07-01\",\"2015-07-01-preview\",\"2015-07-01\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2017-05-01\"}]},{\"resourceType\":\"elevateAccess\",\"locations\":[],\"apiVersions\":[\"2017-05-01\",\"2016-07-01\",\"2015-07-01\",\"2015-06-01\",\"2015-05-01-preview\",\"2014-10-01-preview\",\"2014-07-01-preview\",\"2014-04-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2017-05-01\"}]},{\"resourceType\":\"checkAccess\",\"locations\":[],\"apiVersions\":[\"2018-09-01-preview\"],\"apiProfiles\":[{\"profileVersion\":\"2018-06-01-profile\",\"apiVersion\":\"2018-09-01-preview\"}]}],\"registrationState\":\"Registered\"}"
                }
            }
        },
        {
            "request": {
                "method": "DELETE",
                "uri": "https://management.azure.com/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy_sub?api-version=2019-01-01",
                "body": null,
                "headers": {}
            },
            "response": {
                "status": {
                    "code": 200,
                    "message": "OK"
                },
                "headers": {
                    "x-ms-routing-request-id": [
                        "WESTUS2:20190503T151551Z:a8fa878b-b131-4987-9782-5623459ca47c"
                    ],
                    "x-ms-request-id": [
                        "westus2:a2e6cf52-9a1e-4207-8a82-c52290d99b38"
                    ],
                    "x-ms-ratelimit-remaining-subscription-deletes": [
                        "14999"
                    ],
                    "Pragma": [
                        "no-cache"
                    ],
                    "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains"
                    ],
                    "Transfer-Encoding": [
                        "chunked"
                    ],
                    "X-Content-Type-Options": [
                        "nosniff"
                    ],
                    "Date": [
                        "Fri, 03 May 2019 15:15:50 GMT"
                    ],
                    "Content-Type": [
                        "application/json; charset=utf-8"
                    ],
                    "Vary": [
                        "Accept-Encoding,Accept-Encoding"
                    ],
                    "x-ms-correlation-request-id": [
                        "a8fa878b-b131-4987-9782-5623459ca47c"
                    ],
                    "Expires": [
                        "-1"
                    ],
                    "Cache-Control": [
                        "no-cache"
                    ],
                    "content-length": [
                        "604"
                    ]
                },
                "body": {
                    "string": "{\"sku\":{\"name\":\"A0\",\"tier\":\"Free\"},\"properties\":{\"displayName\":\"cctestpolicy_sub\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\"scope\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47\",\"metadata\":{\"createdBy\":\"3857c640-b81d-4a7b-b006-ca39332fddb2\",\"createdOn\":\"2019-05-03T15:15:48.3275321Z\",\"updatedBy\":null,\"updatedOn\":null}},\"id\":\"/subscriptions/ea42f556-5106-4743-99b0-c129bfa71a47/providers/Microsoft.Authorization/policyAssignments/cctestpolicy_sub\",\"type\":\"Microsoft.Authorization/policyAssignments\",\"name\":\"cctestpolicy_sub\"}"
                }
            }
        }
    ]
}